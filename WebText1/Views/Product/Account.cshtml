@{
    Layout = "~/Views/Shared/_HomeLayout.cshtml";
}

<link href="~/Content/account/account.css" rel="stylesheet" />
<section class="account-container">
    @* ===== FORM ĐĂNG NHẬP ===== --> *@
    <div class="login-box" id="loginForm">
        <h2>Đăng nhập</h2>
        <div id="errorMessage" class="error-message" style="display:none;"></div>
        <div id="successMessage" class="success-message" style="display:none;"></div>

        <label for="email">Địa chỉ Email</label>
        <input type="text" id="email" placeholder="Nhập email của bạn" />

        <label for="password">Mật khẩu</label>
        <input type="password" id="password" placeholder="Nhập mật khẩu" />

        <a href="#" class="forgot-password">Quên mật khẩu</a>

        <button type="button" id="loginBtn">ĐĂNG NHẬP</button>

        <p class="register-link">
            <a href="#" id="showRegister">Đăng ký</a>
        </p>
    </div>

    <!-- ===== FORM ĐĂNG KÝ ===== -->
    <div class="login-box" id="registerForm" style="display:none;">
        <h2>Tạo tài khoản</h2>
        <div id="registerMessage" class="error-message" style="display:none;"></div>
        <div id="registerSuccess" class="success-message" style="display:none;"></div>

        <label for="firstName">Tên</label>
        <input type="text" id="firstName" placeholder="Nhập tên của bạn" />

        <label for="lastName">Họ</label>
        <input type="text" id="lastName" placeholder="Nhập họ của bạn" />

        <label for="registerEmail">Email</label>
        <input type="text" id="registerEmail" placeholder="Nhập email của bạn" />

        <label for="registerPassword">Mật khẩu</label>
        <input type="password" id="registerPassword" placeholder="Tạo mật khẩu" />

        <label><input type="checkbox" /> Đăng ký</label>

        <button type="button" id="registerBtn">ĐĂNG KÝ</button>

        <p class="register-link">
            <a href="#" id="showLogin">Đăng nhập</a>
        </p>
    </div>
</section>
<script language="JavaScript">
    document.addEventListener("DOMContentLoaded", function () {
        // ==== CHUYỂN GIỮA FORM ====
        document.getElementById("showRegister").addEventListener("click", function (e) {
            e.preventDefault();
            document.getElementById("loginForm").style.display = "none";
            document.getElementById("registerForm").style.display = "block";
        });
        document.getElementById("showLogin").addEventListener("click", function (e) {
            e.preventDefault();
            document.getElementById("registerForm").style.display = "none";
            document.getElementById("loginForm").style.display = "block";
        });
        // ==== KIỂM TRA ĐĂNG NHẬP ====
        document.getElementById("loginBtn").addEventListener("click", function () {
            const email = document.getElementById("email").value.trim();
            const password = document.getElementById("password").value.trim();
            const errorDiv = document.getElementById("errorMessage");
            const successDiv = document.getElementById("successMessage");
            errorDiv.style.display = "none";
            successDiv.style.display = "none";

            if (email === "" || password === "") {
                errorDiv.innerHTML = "<ul><li>Vui lòng nhập đầy đủ email và mật khẩu.</li></ul>";
                errorDiv.style.display = "block";
                return;
            }
            let users = JSON.parse(localStorage.getItem("users")) || [];
            let found = users.find(u => u.email === email && u.password === password);
            if (!found) {
                errorDiv.innerHTML = "<ul><li>Email hoặc mật khẩu không đúng.</li></ul>";
                errorDiv.style.display = "block";
                return;
            }
            successDiv.textContent = "Đăng nhập thành công! Xin chào " + found.firstName + " " + found.lastName;
            successDiv.style.display = "block";
        });

        // ==== KIỂM TRA ĐĂNG KÝ ====
        document.getElementById("registerBtn").addEventListener("click", function () {
            const firstName = document.getElementById("firstName").value.trim();
            const lastName = document.getElementById("lastName").value.trim();
            const email = document.getElementById("registerEmail").value.trim();
            const password = document.getElementById("registerPassword").value.trim();
            const errorDiv = document.getElementById("registerMessage");
            const successDiv = document.getElementById("registerSuccess");
            errorDiv.style.display = "none";
            successDiv.style.display = "none";
            if (firstName === "" || lastName === "" || password === "" || email === "") {
                errorDiv.innerHTML = "<ul><li>Vui lòng điền đầy đủ thông tin.</li></ul>";
                errorDiv.style.display = "block";
                return;
            }
            if (!email.endsWith("gmail.com")) {
                errorDiv.innerHTML = "<ul><li>Email phải có dạng gmail.com.</li></ul>";
                errorDiv.style.display = "block";
                return;
            }
            let users = JSON.parse(localStorage.getItem("users")) || [];
            let exists = users.find(u => u.email === email);
            if (exists) {
                errorDiv.innerHTML = "<ul><li>Email này đã được đăng ký.</li></ul>";
                errorDiv.style.display = "block";
                return;
            }

            let newUser = { firstName, lastName, email, password };
            users.push(newUser);
            localStorage.setItem("users", JSON.stringify(users));
            successDiv.textContent = "Đăng ký thành công! Bạn có thể đăng nhập ngay.";
            successDiv.style.display = "block";
            document.getElementById("firstName").value = "";
            document.getElementById("lastName").value = "";
            document.getElementById("registerEmail").value = "";
            document.getElementById("registerPassword").value = "";
        });

    });
</script>

